# Copyright (C) 2022 Freetech Solutions

# This file is part of OMniLeads

# This program is free software: You can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.

# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY, without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
# GNU General Public License for more details.

# You should have received a copy of the GNU General Public License
# along with this program. If not, see http://www.gnu.org/licenses/.

---
# OMniLeads installation playbook
# It uses the files group_vars/all and inventory, as environment variables
# It uses the file /var/tmp/ansible/ansible.cfg, as configuration file

- name: OMniLeads installation
  hosts: omnileads-app
  gather_facts: True
  roles:
    - prerequisitos

- import_playbook: components/minio/playbook.yml
  when: bucket_url is not defined

- import_playbook: components/redis/playbook.yml
  when: redis_local == true

- import_playbook: components/postgresql/playbook.yml
  when: postgres_local == true

- import_playbook: components/rtpengine/playbook.yml
  when: rtpengine_local == true

- import_playbook: components/kamailio/playbook.yml
  when: kamailio_local == true

- import_playbook: components/websockets/playbook.yml
  when: websocket_local == true

- import_playbook: components/asterisk/playbook.yml
  when: asterisk_local == true

- import_playbook: components/django/playbook.yml
  when: django_local == true

- import_playbook: components/nginx/playbook.yml
  when: nginx_local == true

- import_playbook: monitoring/prometheus/playbook.yml
  when: prometheus_enable is defined
